<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Italy ZTL Map â€“ Official Boundaries & Cameras</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html, body { margin:0; padding:0; height:100%; }
#map { width:100%; height:100%; }
</style>
</head>

<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/esri-leaflet@3.0.11/dist/esri-leaflet.js"></script>

<script>
const map = L.map('map').setView([43.0, 12.5], 6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

const areaBStyle = { color:'#4575b4', weight:2, fillOpacity:0.12 };
const areaCStyle = { color:'#d73027', weight:2, fillOpacity:0.18 };

const cameraIcon = L.icon({
  iconUrl: 'https://cdn-icons-png.flaticon.com/512/814/814513.png',
  iconSize: [18,18],
  iconAnchor: [9,9]
});

/* ---------- MILAN (HTTPS-SAFE) ---------- */
const milanAreaB = L.esri
  .query({
    url: 'https://geoservices.comune.milano.it/arcgis/rest/services/AREAB/FeatureServer/0'
  })
  .where('1=1')
  .run((error, fc) => {
    if (!error) L.geoJSON(fc, {style: areaBStyle}).addTo(map);
  });

const milanAreaC = L.esri
  .query({
    url: 'https://geoservices.comune.milano.it/arcgis/rest/services/AREAC/FeatureServer/0'
  })
  .where('1=1')
  .run((error, fc) => {
    if (!error) L.geoJSON(fc, {style: areaCStyle}).addTo(map);
  });

const milanCameras = L.esri
  .query({
    url: 'https://geoservices.comune.milano.it/arcgis/rest/services/VARCHI_ZTL/FeatureServer/0'
  })
  .where('1=1')
  .run((error, fc) => {
    if (!error) {
      L.geoJSON(fc, {
        pointToLayer: (f,latlng)=>L.marker(latlng,{icon:cameraIcon}),
        onEachFeature:(f,l)=>l.bindPopup("Milan ZTL Camera")
      }).addTo(map);
    }
  });

</script>
</body>
</html>
